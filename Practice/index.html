<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <!-- <button onclick="addPost()">Add Post</button> -->

    <form id="formCreate">
        <label for="">insert title</label>
        <br />
        <input type="text" required />
        <br />
        <label for="">insert views</label>
        <br />
        <input type="number" required />
        <br />
        <br />
        <button type="submit">Create Post</button>
      </form>
      <form id="formDelete">
        <label for="">insert post id</label>
        <br />
        <input type="text" required />
        <br />
        <br />
        <button type="submit">Delete Post</button>
      </form>
      <p id="postLength"></p>
      <p id="success" style="color: green"></p>
      <p id="failure" style="color: red"></p>


    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script>
      /*function addPost() {
        const url = "http://localhost:3000/posts";
        const body = {
          id:'12345678',
          title: "a title",
          views: 100,
        };
        axios
          .post(url, body)
          .then(function (response) {
            console.log(response);
          })
          .catch(function (error) {
            console.log(error);
          });
      }*/


    const elemFormCreate = document.querySelector("#formCreate");
    const elemInputTitle = elemFormCreate.querySelectorAll("input")[0];
    const elemInputViews = elemFormCreate.querySelectorAll("input")[1];
    const elemPostsLength = document.querySelector("#postLength");
    const elemFormDelete = document.querySelector("#formDelete");
    const elemInputIdToDelete = elemFormDelete.querySelector("input");

    const baseUrl = "http://localhost:3000";
    const elemSuccess = document.querySelector("#success");
    const elemFailure = document.querySelector("#failure");
    const urlPosts = `${baseUrl}/posts`;
    elemFormCreate.addEventListener("submit", addPost);

    function getLength() {
    axios
        .get(urlPosts)
        .then(function (response) {
        const posts = response.data;
        elemPostsLength.innerText = posts.length;
        setSuccess();
        })
        .catch(function (error) {
        setFailure();
        });
    }

    function setSuccess() {
    elemSuccess.innerText = "success";
    }

    function deletePost(e) {
        e.preventDefault();
        const url = `${baseUrl}/${elemInputIdToDelete.value}`;
        try {
            axios.delete(url);
            setSuccess();
        } catch (error) {
            setFailure();
        }
    }

    function addPost(e) {
        e.preventDefault();
        const body = {
            title: elemInputTitle.value,
            views: elemInputViews.value,
        };
        axios
            .post(urlPosts, body)
            .then(function (response) {
            getLength();
            console.log(response);
            setSuccess();
            })
            .catch(function (error) {
            console.log(error);
            setFailure();
            });
        }

    function setFailure() {
    elemFailure.innerText = "failure";
    }


    </script>
  </body>
</html>